<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="courseRegister">
	<resultMap id="courseRegisterMap" type="courseRegister3">
		<id column="course_no" property="courseRegisterNo"/>
		<result column="course_title" property="courseRegisterDate"/>
		<result column="course_desc" property="progressRate"/>
		<result column="course_category_no" property="lastViewTime"/>
		<result column="grade" property="completionStatus"/>
		<result column="course_price" property="courseNo"/>
		<result column="course_price_sale" property="courseScore"/>
		<result column="course_period" property="reviewContent"/>
		<result column="member_no" property="memberNo"/>
		<result column="teacher_subject_name" property="teacherSubjectName"/>
		
		<association property="Course3" resultMap="course.courseMap"/>
	</resultMap>
	
    <!-- 진행중인 강좌 조회 쿼리 -->
    <select id="selectIngCourse" parameterType="int" resultMap="courseRegisterMap">
        SELECT 
            CR.*, C.COURSE_TITLE, C.TOTAL_LECTURES,
            M.MEMBER_NAME AS TEACHER_NAME
        FROM 
            COURSE_REGISTER3 CR
            JOIN COURSE3 C ON CR.COURSE_NO = C.COURSE_NO
            JOIN MEMBER3 M ON C.MEMBER_NO = M.MEMBER_NO
        WHERE 
            CR.COMPLETION_STATUS = 0 
            AND CR.MEMBER_NO = #{memberNo}
        ORDER BY 
            CR.LAST_VIEW_TIME DESC
    </select>
</mapper>
